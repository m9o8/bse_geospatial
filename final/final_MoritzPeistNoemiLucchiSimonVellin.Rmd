---
title: "California Road Construction Safety Analysis: A Spatial Econometric Approach"
author:
- Moritz Peist
- Noemi Lucchi
- Simon Vellin
date: "`r withr::with_locale(c('LC_TIME' = 'en_US.UTF-8'), format(Sys.Date(), '%B %d, %Y'))`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    df_print: paged
    code_folding: show
    fig_caption: true
    number_sections: true
    progress: false
    warning: false
---

```{css, echo=FALSE}
h1.title {
  text-align: center;
}

h4.author, h4.date {
  text-align: center;
}

.author {
  text-align: center;
}

.date {
  text-align: center;
}

h3.subtitle {
  text-align: center;
  font-style: italic;
  margin-top: -10px;
  color: #606060;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE, 
  message = FALSE,
  progress = FALSE,
  fig.width = 8,
  fig.height = 5,
  out.width = "100%",
  fig.align = "center",
  comment = "#>"
)

# Load required libraries
library(data.table)      # For faster data manipulation
library(tidyverse)       # For data manipulation and visualization
library(sf)              # For spatial data handling
library(leaflet)         # For interactive maps
library(leaflet.extras)  # For additional leaflet features
library(mapview)         # For easier map visualization
library(tmap)            # For thematic maps
library(tigris)          # For US road networks
library(fixest)          # For fixed effects models
library(spdep)           # For spatial weights and tests
library(splm)            # For spatial panel models
library(RColorBrewer)    # For color palettes
library(patchwork)       # For combining plots
library(kableExtra)      # For nice tables
library(lubridate)       # For date manipulation
library(viridis)         # For color palettes

# Create directories if they don't exist
if (!dir.exists("./data/tigris")) {
  dir.create("./data/tigris", recursive = TRUE)
}

# Set custom cache directory
options(tigris_cache_dir = "./data/tigris")
# Configure tigris to use caching
options(tigris_use_cache = TRUE)
```

<div style="text-align: center;">
  <img src="../Barcelona_School_of_Economics_logo.svg" alt="BSE logo" style="width: 200px;">
</div>

# Abstract

This study examines the causal relationship between road construction activities and traffic accident rates in California using high-resolution spatial data from 2021. Implementing a difference-in-differences framework with spatial controls, we analyze how construction zones affect accident frequency and severity. Our findings indicate a significant relationship between active construction and accident occurrence, with heterogeneous effects across urban and rural environments. Spatial spillover analysis reveals that accident impacts extend beyond immediate construction zones, with pronounced effects in areas surrounding construction sites. This research provides evidence-based insights for transportation safety planning and targeted mitigation strategies.

# Introduction

Road construction is a necessary yet potentially disruptive component of transportation infrastructure maintenance and development. While essential for long-term safety improvements, construction activities create temporary changes in traffic patterns, road conditions, and driver behavior that may increase accident risk. Understanding the causal relationship between construction activities and traffic safety has important implications for construction scheduling, resource allocation, traffic management strategies, and policy development.

Despite the importance of this relationship, rigorous causal evidence on how road construction affects traffic accidents remains limited, particularly with respect to potential heterogeneity between urban and rural environments. This study addresses this gap by leveraging comprehensive spatial data on road construction activities and traffic accidents in California during 2021 to answer the following research questions:

1. How does road construction causally impact traffic accident rates?
2. Do these effects systematically differ between urban and rural environments?
3. Are there spatial spillover effects beyond the immediate construction zones?

The findings of this research have direct implications for transportation safety planning, particularly regarding how resources should be allocated for traffic management during construction activities across different environments.

# Literature Review

To establish a contextual foundation for our study, we reviewed existing literature on the relationship between road construction and traffic accidents, focusing on studies that use spatial or causal inference approaches.

## ["Effects of truck traffic on crash injury severity on rural highways in Wyoming using Bayesian binary logit models" by Ahmed et al. (2018)](https://www.sciencedirect.com/science/article/pii/S0001457518301507)

This paper explores the impact of truck traffic and roadway geometry on crash frequency within highway work zones, using a case study from Wyoming spanning 2012–2016.

Using crash data and statistical modeling, the authors assess how construction-related factors, like lane closures and heavy vehicle presence, elevate accident risks. Their paper reveals that increased truck volumes and sharper geometric features significantly amplify crash rates, with work zones acting as hotspots for such incidents. While the paper employs logistic regression rather than causal inference techniques, it underscores the real-world relevance of construction disruptions on traffic safety.

This work provides a practical foundation for our study, highlighting the need to isolate causal effects of construction using advanced methods. By focusing on observable crash patterns, Ahmed et al. set the stage for deeper methodological exploration in our difference-in-differences framework.

## ["Comparison of characteristics between fatal and injury accidents in the highway construction zones" by Li and Bai (2008)]( https://www.sciencedirect.com/science/article/pii/S0925753507001014)

This paper investigates the characteristics of accidents in highway construction zones from a statistical perspective, comparing fatal and injury crashes using data from Utah between 1992 and 2004.

Using traffic volume, construction duration, and time of day, their results show that construction zones markedly increase accident likelihood, with fatal crashes tied to higher speeds and nighttime conditions. Although the study relies on descriptive statistics and regression rather than causal frameworks, it offers critical insights into how construction alters road safety dynamics.

## Accident Risk in Highway Construction Zones

The relationship between construction activities and traffic accidents has been investigated in several studies. Ahmed et al. (2018) explored the impact of truck traffic and roadway geometry on crash frequency within highway work zones in Wyoming. Their analysis revealed that increased truck volumes and sharper geometric features significantly amplified crash rates, with work zones acting as hotspots for accidents. While their study employed logistic regression rather than causal inference techniques, it highlighted the real-world relevance of construction disruptions on traffic safety.

Li and Bai (2008) compared the characteristics of fatal and injury crashes in highway construction zones using data from Utah (1992-2004). Their results showed that construction zones markedly increase accident likelihood, with fatal crashes tied to higher speeds and nighttime conditions. Although they relied on descriptive statistics rather than causal frameworks, their work established a clear link between construction activities and accident rates.

The literature generally suggests that construction zones are associated with increased accident risk, but most studies have not employed causal inference methods to isolate this effect from confounding factors. Additionally, few studies have examined the spatial heterogeneity of construction effects on accidents, particularly regarding urban-rural differences. Our study addresses these gaps by employing a difference-in-differences framework with spatial controls to identify the causal impact of construction activities on accident rates.

# Data and Methods

## Data Sources

This study integrates multiple large-scale datasets to create a comprehensive spatial-temporal framework for analysis:

**Primary Datasets:**

  1. [**US Road Construction and Closures Dataset (2021)**](https://www.kaggle.com/datasets/sobhanmoosavi/us-road-construction-and-closures) - Contains detailed records of construction activities in California with coordinates, start/end times, and affected distances
  2. [**US Traffic Accidents Dataset (2021)**](https://www.kaggle.com/datasets/sobhanmoosavi/us-accidents) - Comprehensive accident records with precise locations, timestamps, and severity measures
  3. [**Caltrans State Highway Network**](https://catalog.data.gov/dataset/traffic-volumes-aadt-ee8d6/resource/904a8300-9b57-4765-8ed7-cca0c83cdede) - Annual Average Daily Traffic (AADT) data for normalizing accident rates by traffic volume
  4. **US Census Bureau Urban Areas** - Official urban/rural classifications for spatial heterogeneity analysis

For both the accident and construction datasets, the data was collected using multiple APIs such as the US and state departments of transportation, law enforcement agencies, traffic cameras, and traffic sensors within the road networks.

While our analysis uses 2021 accident and construction data, we integrated Annual Average Daily Traffic (AADT) data from Caltrans to normalize accident rates. The AADT dataset provides a comprehensive traffic volume baseline that reflects typical traffic patterns, mitigating potential short-term fluctuations. Though the AADT data may include projections or estimates from surrounding years, it represents the most reliable and granular traffic volume information available, enabling more precise exposure-adjusted accident rate calculations.

## Data Preparation and Exploration

We focused our analysis on California road construction and accidents from 2021, creating a spatial-temporal framework that allows us to examine the causal relationship between construction activities and accidents.

```{r data_loading}
# Redirect all output to a temporary file (suppresses progress bars)
sink(tempfile())

# Load Caltrans State Highway Network
aadt <- st_read("data/Traffic_Volumes_AADT/Traffic_Volumes_AADT.shp")

# Load and filter accidents data
df.acc <- fread("data/us_accidents/US_accidents_March23.csv")[
  # Filter date range of 2021
  lubridate::year(as.Date(Start_Time)) == 2021 & 
  # And California
  State == "CA"
][, `:=`(
  # Add year, quarter, month columns
  year = data.table::year(Start_Time),
  quarter = data.table::quarter(Start_Time),
  month = data.table::month(Start_Time),
  # Calculate duration
  duration = as.numeric(difftime(End_Time, Start_Time, units = "days"))
)] %>% 
  as_tibble()

# Load and filter construction data
df.const <- fread("data/us_constructions/US_constructions_Dec21.csv")[
  # Filter date range of 2021
  lubridate::year(as.Date(Start_Time)) == 2021 & 
  # And California
  State == "CA"
][, `:=`(
  # Add year, quarter, month columns
  year = year(Start_Time),
  quarter = quarter(Start_Time),
  month = month(Start_Time),
  # Calculate duration
  duration = as.numeric(difftime(End_Time, Start_Time, units = "days"))
)][
  duration > 1  # Filter out constructions lasting less than a day
] %>% 
  as_tibble()

# Load California road network for mapping
ca_roads <- tigris::primary_roads("CA", year = 2021, refresh=TRUE) %>%
  st_transform(4326)

# Restore normal output
sink()
```

```{r data_summary}
# Calculate and display actual data summary
accidents_count <- nrow(df.acc)
construction_count <- nrow(df.const)
aadt_count <- nrow(aadt)

cat("Summary of datasets:\n")
cat("- Accidents dataset:", accidents_count, "records\n")
cat("- Construction dataset:", construction_count, "records\n")
cat("- AADT dataset:", aadt_count, "records\n")
```

### Traffic Volumes
```{r AADT visualization}
# Data Preparation: Aggregate Traffic Volume
traffic_data_aggregated <- aadt %>%
  mutate(across(c(BACK_AADT, AHEAD_AADT, BACK_PEAK_, AHEAD_PEAK), 
                ~as.numeric(as.character(.)))) %>%
  # Average traffic volumes from both directions
  mutate(
    aadt = rowMeans(cbind(AHEAD_AADT, BACK_AADT), na.rm = TRUE),
    avg_peak_traffic = rowMeans(cbind(BACK_PEAK_, AHEAD_PEAK), na.rm = TRUE)
  ) %>%
  # Remove initial columns 
  select(-c(AHEAD_AADT, BACK_AADT, AHEAD_PEAK, BACK_PEAK_, AHEAD_PE_1, BACK_PEA_1))

# Visualization of Annual Average Daily Traffic
traffic_roads_plot <- ggplot() +
  # Add California road network as background
  geom_sf(data = ca_roads, color = "gray50", size = 1.5, linetype = "solid") +
  
  # Add traffic volume data points
  geom_sf(data = traffic_data_aggregated %>% filter(!is.na(aadt)),
          aes(color = aadt), 
          size = 2) +
  
  # Use viridis color palette for continuous traffic volume
  scale_color_viridis_c(
    name = "Annual Average\nDaily Traffic",
    option = "plasma",
    labels = scales::comma,
    direction = 1
  ) +
  
  # Zoom in to California boundaries
  coord_sf(
    xlim = c(-124.5, -114.5),  # Longitude limits for California
    ylim = c(32.5, 42.5),      # Latitude limits for California
    expand = FALSE
  ) +
  
  # Customize plot theme
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "right",
    legend.title = element_text(face = "bold")
  ) +
  
  # Add informative title and subtitle
  labs(
    title = "California Road Traffic Volumes",
    subtitle = "Spatial Distribution of Annual Average Daily Traffic for Post Miles",
    caption = "Data source: Caltrans State Highway Network"
  )

# Display the plot
print(traffic_roads_plot)
```
The visualization reveals the spatial distribution of Annual Average Daily Traffic (AADT) across California's road network. The highest traffic volumes (indicated by yellow and red points) are concentrated in major urban centers, particularly around Los Angeles, San Francisco, and San Diego metropolitan areas, with volumes exceeding 200,000 vehicles per day in some locations. Rural and mountainous regions show significantly lower traffic volumes (dark purple), often below 50,000 vehicles per day. This spatial variation in traffic exposure is essential for our analysis, as it provides context for normalizing accident rates and understanding how construction impacts might differ between high and low-traffic areas.

### Temporal Patterns

```{r temporal_patterns}
# Temporal patterns visualization using actual data
acc_monthly <- df.acc %>%
  mutate(month = floor_date(as.Date(Start_Time), "month")) %>%
  count(month)

const_monthly <- df.const %>%
  mutate(month = floor_date(as.Date(Start_Time), "month")) %>%
  count(month)

# Plot monthly patterns
p1 <- ggplot(acc_monthly, aes(x = month, y = n)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "blue", size = 3) +
  labs(title = "Monthly Accidents in California (2021)",
       x = "Month", y = "Count") +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

p2 <- ggplot(const_monthly, aes(x = month, y = n)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 3) +
  labs(title = "New Construction Projects in California (2021)",
       x = "Month", y = "Count") +
  scale_x_date(date_labels = "%b", date_breaks = "1 month") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

p1 / p2
```

The temporal distribution reveals a striking inverse relationship between accidents and construction projects throughout 2021. Accident rates show clear seasonality with peaks in January (~38,000 accidents) and December (~36,000 accidents), and a notable drop in March-April (~20,000 accidents). In contrast, construction activity peaks in March (~5,000 new projects) – precisely when accident rates are lowest – and maintains a relatively high level through June, before gradually declining toward the end of the year. This pattern suggests that seasonal factors such as weather conditions and daylight hours may influence both construction planning and accident occurrence, with transportation agencies potentially scheduling more construction during periods of historically lower accident rates.

### Spatial Distribution

Let's examine the spatial distribution of accidents and construction sites across California.

```{r spatial_processing}
# Create spatial objects from actual data
if (!inherits(df.acc, "sf")) {
  df.acc.sf <- df.acc %>%
    filter(!is.na(Start_Lat) & !is.na(Start_Lng)) %>%
    st_as_sf(coords = c("Start_Lng", "Start_Lat"), crs = 4326) %>%
    st_transform(crs = 3310)  # CA Albers for accurate distance
} else {
  df.acc.sf <- df.acc
}

if (!inherits(df.const, "sf")) {
  df.const.sf <- df.const %>%
    filter(!is.na(Start_Lat) & !is.na(Start_Lng)) %>%
    st_as_sf(coords = c("Start_Lng", "Start_Lat"), crs = 4326) %>%
    st_transform(crs = 3310)
} else {
  df.const.sf <- df.const
}
```

```{r static_maps}
# Create a subsample for visualization (plotting all points would be too dense)
set.seed(123)
acc_sample <- df.acc.sf %>%
  sample_n(min(10000, nrow(.)))

const_sample <- df.const.sf %>%
  sample_n(min(5000, nrow(.)))

# Static map for Accidents with month coloring
ca_acc_plot <- ggplot() +
  geom_sf(data = ca_roads, color = "gray80", size = 0.1) +
  geom_sf(data = acc_sample, 
          aes(color = factor(month)), alpha = 0.5, size = 0.5) +
  scale_color_viridis_d(name = "Month", option = "plasma") +
  coord_sf(
    xlim = c(-124.5, -114.5),
    ylim = c(32.5, 42.5)
  ) +
  theme_minimal() +
  labs(title = "California Road Accidents (2021)") +
  theme(legend.position = "bottom")

# Construction sites map with severity coloring
ca_const_plot <- ggplot() +
  geom_sf(data = ca_roads, color = "gray80", size = 0.1) +
  geom_sf(data = const_sample, 
          aes(color = factor(Severity)), alpha = 0.7, size = 0.5) +
  scale_color_viridis_d(name = "Severity", option = "plasma") +
  coord_sf(
    xlim = c(-124.5, -114.5),
    ylim = c(32.5, 42.5)
  ) +
  theme_minimal() +
  labs(title = "California Construction Sites by Severity (2021)") +
  theme(legend.position = "bottom")

# Display the plots
ca_acc_plot
ca_const_plot
```

The spatial distribution maps reveal strong geographic patterns for both accidents and construction activities in California. Accidents (top map) are heavily concentrated along major transportation corridors and urban centers, with particularly high densities in the Los Angeles Basin, San Francisco Bay Area, and the Central Valley along Interstate 5. The temporal coloring shows some month-to-month variation but suggests relatively consistent spatial patterns throughout the year. 

Similarly, construction sites (bottom map) follow the state's major transportation infrastructure, with higher concentrations in metropolitan areas. The severity classification shows a mix of construction types across regions, with higher severity projects (darker colors) somewhat more prevalent in urban cores. This spatial correlation between accidents and construction sites highlights the importance of controlling for location-specific factors in our causal analysis, as both are influenced by underlying traffic patterns and infrastructure density.

### Density Heatmaps

To better visualize the spatial concentration, we created heatmaps for both accidents and construction sites.

```{r heatmaps}
# Sample data for creating heatmaps (using smaller sample for performance)
set.seed(123)
acc_sample_for_heatmap <- df.acc %>%
  filter(!is.na(Start_Lat) & !is.na(Start_Lng)) %>%
  sample_n(min(50000, nrow(.)))

const_sample_for_heatmap <- df.const %>%
  filter(!is.na(Start_Lat) & !is.na(Start_Lng)) %>%
  sample_n(min(10000, nrow(.)))

# Create heatmap of accidents using ggplot2
accident_heatmap <- ggplot() +
  geom_sf(data = ca_roads, color = "gray80", size = 0.1) +
  stat_density_2d(
    data = acc_sample_for_heatmap,
    aes(x = Start_Lng, y = Start_Lat, fill = after_stat(density), alpha = after_stat(density)),
    geom = "tile", 
    contour = FALSE,
    h = 0.2,  # Increased bandwidth for better visualization
    n = 150
  ) +
  scale_alpha_continuous(range = c(0, 0.9), guide = "none") +
  scale_fill_gradientn(
    colors = c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FF0000"),
    name = "Accident\nDensity"
  ) +
  coord_sf(
    xlim = c(-124.5, -114.5),
    ylim = c(32.5, 42.5)
  ) +
  theme_minimal() +
  labs(
    title = "Accident Density Heatmap in California (2021)",
    x = NULL,
    y = NULL
  ) +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold")
  )

# Construction sites heatmap
construction_heatmap <- ggplot() +
  geom_sf(data = ca_roads, color = "gray80", size = 0.1) +
  stat_density_2d(
    data = const_sample_for_heatmap,
    aes(x = Start_Lng, y = Start_Lat, fill = after_stat(density)),
    geom = "tile", 
    contour = FALSE,
    alpha = 0.7,
    h = 0.2,
    n = 150
  ) +
  scale_fill_gradientn(
    colors = c("yellow", "orange", "red"),
    name = "Construction\nDensity",
    na.value = NA,  # Makes low-density areas transparent
    limits = c(0.001, NA)  # Sets minimum value to show (adjust as needed)
  ) +
  coord_sf(
    xlim = c(-124.5, -114.5),
    ylim = c(32.5, 42.5)
  ) +
  theme_minimal() +
  labs(
    title = "Construction Density Heatmap in California (2021)",
    x = NULL,
    y = NULL
  ) +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold")
  )

# Display the heatmaps
accident_heatmap
construction_heatmap
```

The density heatmaps provide a striking visualization of the spatial concentration patterns for both accidents and construction activities across California. The accident heatmap (top) reveals intense clustering in major urban centers, with the Los Angeles metropolitan area showing the highest density (red), followed by the San Francisco Bay Area and San Diego (yellow-green). Several medium-intensity clusters (blue-cyan) appear along major highways in the Central Valley.

Similarly, the construction density heatmap (bottom) shows pronounced concentration in the same urban areas, with particularly high intensity (red-orange) in Los Angeles and the Bay Area. These parallel patterns strongly suggest that both accidents and construction activities follow underlying population and traffic volume distributions. This spatial correlation underscores the importance of our difference-in-differences approach with location fixed effects, which will help isolate the causal impact of construction on accidents by controlling for these shared geographic determinants.

### Urban-Rural Classification

We classified construction sites as urban or rural based on their intersection with US Census Bureau urban areas. This classification is crucial for our heterogeneity analysis.

```{r urban_rural}
# Download urban areas for California
ca_urban_areas <- tigris::urban_areas(cb = TRUE, year = 2019) %>%
  st_transform(st_crs(df.const.sf)) %>%
  filter(grepl(", CA$", NAME10))

# Classify construction sites as urban or rural
const_urban <- st_join(
  df.const.sf,
  ca_urban_areas %>% select(urban_name = NAME10),
  join = st_intersects
)

const_urban <- const_urban %>%
  mutate(is_urban = !is.na(urban_name))
```

```{r urban_rural_table}
# Calculate actual urban-rural distribution
urban_rural_df <- const_urban %>%
  st_drop_geometry() %>%
  count(is_urban) %>%
  mutate(percentage = n / sum(n) * 100)

kableExtra::kable(urban_rural_df, 
                 col.names = c("Urban Area", "Count", "Percentage (%)"),
                 caption = "Distribution of Construction Sites by Urban/Rural Classification",
                 booktabs = TRUE,
                 digits = 1) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"),
                           full_width = FALSE) %>%
  kableExtra::row_spec(0, bold = TRUE)
```

The urban-rural classification shows that approximately 66.1% of construction sites in our dataset are located in urban areas, while 33.9% are in rural areas. This distribution is essential for our heterogeneity analysis, as it ensures we have sufficient observations in both urban and rural categories to detect differential effects. The substantial representation of both categories allows us to investigate how construction impacts accident rates differently across these distinct environments, which has important implications for targeted safety measures and resource allocation.

### Integration with Traffic Volume Data

To control for exposure to traffic, we integrated Annual Average Daily Traffic (AADT) data from Caltrans, allowing us to normalize accident counts by traffic volume.

```{r traffic_volume}
# Transform AADT data to ensure matching CRS
aadt_sf <- st_transform(aadt, st_crs(df.const.sf))

# Convert AADT columns to numeric
aadt_sf <- aadt_sf %>%
  mutate(
    BACK_AADT_num = as.numeric(as.character(BACK_AADT)),
    AHEAD_AADT_num = as.numeric(as.character(AHEAD_AADT))
  )

# Find the nearest AADT point for each construction buffer
nearest_indices <- st_nearest_feature(df.const.sf, aadt_sf)
nearest_distances <- st_distance(df.const.sf, aadt_sf[nearest_indices,], by_element = TRUE)

# Create a dataframe with buffer IDs and nearest AADT values
buffer_aadt <- df.const.sf %>%
  mutate(buffer_id = paste0("c", row_number())) %>%
  select(buffer_id) %>%
  bind_cols(
    aadt_sf[nearest_indices, ] %>%
    select(BACK_AADT_num, AHEAD_AADT_num)
  ) %>%
  mutate(
    distance_to_nearest = as.numeric(nearest_distances),
    traffic_volume = rowMeans(cbind(BACK_AADT_num, AHEAD_AADT_num), na.rm = TRUE)
  ) %>%
  st_drop_geometry() %>%
  select(buffer_id, traffic_volume, distance_to_nearest)

# Summary of traffic volumes
summary(buffer_aadt$traffic_volume)
```

```{r traffic_distribution}
# Plot actual traffic volume distribution
ggplot(buffer_aadt, aes(x = traffic_volume)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", alpha = 0.8) +
  labs(
    title = "Distribution of Annual Average Daily Traffic (AADT)",
    x = "Traffic Volume (vehicles per day)",
    y = "Count"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Log-scale for better visualization of the distribution
ggplot(buffer_aadt, aes(x = traffic_volume)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", alpha = 0.8) +
  scale_x_log10() +
  labs(
    title = "Distribution of Annual Average Daily Traffic (AADT) - Log Scale",
    x = "Traffic Volume (vehicles per day) - Log Scale",
    y = "Count"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
```

The traffic volume distribution shows substantial variation across construction sites, with a median AADT of 72,000 vehicles per day but ranging from as low as 107 to over 379,000 vehicles per day. The right-skewed distribution (evident in the first histogram) indicates that most construction sites experience moderate traffic volumes, while a smaller number of sites have extremely high traffic. The log-scale visualization reveals a more nuanced bimodal pattern, suggesting two distinct categories of roads: lower-volume rural or suburban routes (clustered around 10^3-10^4 vehicles/day) and higher-volume urban arterials and highways (clustered around 10^5 vehicles/day). This considerable variation in traffic exposure is critical to control for in our analysis, as it directly affects the accident risk baseline across different locations.

## Construction Buffer Analysis

To establish the spatial relationship between accidents and construction activities, we created buffer zones around construction locations and analyzed accidents within these zones.

```{r construction_buffers}
# Create construction buffers (500m)
const_buffers <- const_urban %>%
  mutate(buffer_id = paste0("c", row_number())) %>%
  st_buffer(dist = 500)  # 500m buffer

# Add buffer metadata
const_buffers <- const_buffers %>%
  mutate(
    start_date = as.Date(Start_Time),
    end_date = as.Date(End_Time),
    construction_duration = as.numeric(difftime(end_date, start_date, units = "days"))
  )

# Join accidents to construction buffers - this operation can be computationally intensive
accidents_in_buffers <- st_join(
  df.acc.sf %>% 
    select(accident_id = ID, accident_date = Start_Time, Severity),
  const_buffers %>% 
    select(buffer_id, construction_id = ID, start_date, end_date, is_urban),
  join = st_intersects
)

# Classify accidents by timing relative to construction
accidents_in_buffers <- accidents_in_buffers %>%
  mutate(
    accident_date = as.Date(accident_date),
    time_period = case_when(
      is.na(start_date) ~ NA_character_,
      accident_date < start_date ~ "before",
      accident_date > end_date ~ "after",
      TRUE ~ "during"
    ),
    month_year = floor_date(accident_date, "month")
  )

# Display the first few rows of the joined data
head(accidents_in_buffers %>% st_drop_geometry())

# Print number of rows
print(nrow(accidents_in_buffers))
```

As it is visible now, the data almost quadruples for accidents in buffers. Preserving all spatial intersections between accidents and construction buffers through an unrestricted join (`st_intersects`) provides a more realistic representation of road safety dynamics, particularly in complex environments where construction activities frequently overlap. By maintaining the many-to-many relationship, our analysis acknowledges that a single accident may be legitimately associated with multiple construction zones, especially in urban corridors where projects occur in close proximity. This approach aligns with our research objective of measuring the overall safety impact of construction presence rather than attributing causality to specific projects. The difference-in-differences framework naturally accommodates this data structure by focusing on the binary treatment state (construction present or absent) within each spatial-temporal unit, while our fixed effects for buffer zones and time periods effectively control for systematic variations in accident frequencies across locations and periods. This methodological approach captures the real-world density patterns of construction activities without requiring artificial deduplication that might obscure important spatial relationships in our road safety analysis.

```{r period_counts_table}
# Count accidents by construction period from actual data
period_df <- accidents_in_buffers %>%
  st_drop_geometry() %>%
  filter(!is.na(time_period)) %>%
  count(time_period) %>%
  mutate(percentage = n / sum(n) * 100)

kableExtra::kable(period_df, 
                 col.names = c("Construction Period", "Count", "Percentage (%)"),
                 caption = "Distribution of Accidents by Construction Period",
                 booktabs = TRUE,
                 digits = 1) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"),
                           full_width = FALSE) %>%
  kableExtra::row_spec(0, bold = TRUE)
```

The distribution of accidents by construction period reveals a notable pattern: 46.2% of accidents within our buffer zones occurred before construction began, 24.1% occurred during active construction, and 29.7% occurred after construction ended. This preliminary finding suggests potential changes in accident patterns associated with construction activities. The relatively lower percentage during construction could indicate several possibilities: (1) driver adaptation to construction zones through increased caution, (2) reduced traffic volume due to drivers avoiding construction areas, or (3) effective traffic management measures during construction. However, this descriptive analysis doesn't control for other factors like location characteristics or seasonal patterns, highlighting the need for our more rigorous difference-in-differences approach.

```{r buffer_visualization}
# Extract LA area data for visualization
la_bbox <- st_bbox(c(xmin = -118.75, ymin = 33.65, xmax = -117.85, ymax = 34.35), crs = st_crs(4326))
la_bbox_sf <- st_as_sfc(la_bbox)

# Filter construction buffers and accidents for LA area
la_buffers <- const_buffers %>%
  st_transform(4326) %>%
  st_filter(la_bbox_sf)

# Sample if there are too many for visualization
if(nrow(la_buffers) > 50) {
  set.seed(123)
  la_buffers <- la_buffers %>% sample_n(50)
}

la_accidents <- df.acc.sf %>%
  st_transform(4326) %>%
  st_filter(la_bbox_sf)

# Sample if there are too many for visualization
if(nrow(la_accidents) > 500) {
  set.seed(123)
  la_accidents <- la_accidents %>% sample_n(500)
}

# Create LA outline
la_outline_sf <- st_as_sf(st_as_sfc(la_bbox))

# Plot
ggplot() +
  geom_sf(data = ca_roads, color = "gray80", size = 0.1) +
  geom_sf(data = la_buffers, fill = "red", alpha = 0.3, color = "red") +
  geom_sf(data = st_centroid(la_buffers), color = "darkred", size = 2) +
  geom_sf(data = la_accidents, color = "blue", size = 1, alpha = 0.6) +
  labs(
    title = "Construction Buffers and Accidents in Los Angeles Area",
    subtitle = "Red areas: 500m construction buffers, Blue points: accidents"
  ) +
  coord_sf(
    xlim = c(-118.75, -117.85), 
    ylim = c(33.65, 34.35)
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5)
  )
```

The visualization of the Los Angeles area provides a clear illustration of the spatial relationship between construction buffers (red circles) and accident locations (blue points). Many accidents cluster within or near the 500-meter construction buffer zones, particularly along major transportation corridors. We observe that some buffers contain dense accident clusters, while others have relatively few accidents, suggesting potential heterogeneity in the impact of construction on accident frequency. This visualization highlights the importance of our buffer-based analytical approach, which allows us to capture localized effects of construction activities on nearby accident patterns while controlling for location-specific factors through fixed effects.

## Methodology

Our analysis employs a difference-in-differences (DiD) framework augmented with spatial controls to identify the causal impact of construction activities on traffic accidents. This approach allows us to address potential endogeneity concerns by controlling for time-invariant location characteristics and time-specific effects.

### Panel Dataset Construction

We created a panel dataset that tracks accidents in each buffer zone over time, with indicators for pre-construction, during-construction, and post-construction periods.

```{r panel_creation}
# Generate all buffer-month combinations
all_months <- seq(as.Date("2021-01-01"), as.Date("2021-12-01"), by = "month")
panel_grid <- expand_grid(
  buffer_id = unique(const_buffers$buffer_id),
  month = all_months
)

# Join buffer characteristics
panel_grid <- panel_grid %>%
  left_join(
    const_buffers %>%
      st_drop_geometry() %>%
      select(buffer_id, construction_id = ID, start_date, end_date, is_urban),
    by = "buffer_id"
  )

# Create treatment indicator
panel_grid <- panel_grid %>%
  mutate(
    treatment = month >= start_date & month <= end_date,
    post_treatment = month > end_date
  )

# Count accidents by buffer and month
monthly_accidents <- accidents_in_buffers %>%
  st_drop_geometry() %>%
  mutate(month = floor_date(accident_date, "month")) %>%
  count(buffer_id, month) %>%
  rename(accident_count = n)

# Join accident counts to panel
panel_data <- panel_grid %>%
  left_join(monthly_accidents, by = c("buffer_id", "month")) %>%
  replace_na(list(accident_count = 0))

# Join traffic volume data
panel_data <- panel_data %>%
  left_join(buffer_aadt, by = "buffer_id")

# Create normalized accident rate
panel_data <- panel_data %>%
  mutate(
    accident_rate = ifelse(traffic_volume > 0, 
                          accident_count / traffic_volume * 10000,  # Per 10,000 vehicles
                          NA)
  )

# Display the first few rows of the panel data
head(panel_data)
```

### Econometric Models

We implemented several model specifications to ensure robustness and to explore heterogeneity in the effects:

#### Base Difference-in-Differences Model

Our baseline model takes the form:

$$accident\_count_{it} = \alpha + \beta_1 treatment_{it} + \gamma_t + \delta_i + \varepsilon_{it}$$

Where:
- $accident\_count_{it}$ is the number of accidents in buffer $i$ at time $t$
- $treatment_{it}$ is a binary indicator for active construction
- $\gamma_t$ represents time fixed effects
- $\delta_i$ represents location fixed effects
- $\varepsilon_{it}$ is the error term

```{r base_model}
# Basic DiD model
did_model <- feols(
  accident_count ~ treatment | buffer_id + month,
  data = panel_data
)

# Display model summary
summary(did_model)
```

The base difference-in-differences model provides compelling evidence for the causal impact of construction on accident rates. The coefficient for active construction (treatment) is 0.101 (p < 0.001), indicating that during construction periods, the average number of accidents in buffer zones increases by approximately 0.101 accidents per month compared to non-construction periods. With clustered standard errors at the buffer level, this effect is highly statistically significant, suggesting a robust relationship. The low within-R² (9.001e-5) is common in fixed effects models with binary treatment variables and indicates that while construction activity explains a small portion of the overall variation in accidents, its effect is statistically meaningful and precisely estimated.

#### Heterogeneity Analysis

To examine differential effects between urban and rural areas, we extended the base model with an interaction term:

$$accident\_count_{it} = \alpha + \beta_1 treatment_{it} + \beta_2 (treatment_{it} \times urban_i) + \gamma_t + \delta_i + \varepsilon_{it}$$

```{r heterogeneity_model}
# DiD with urban/rural interaction
did_urban_model <- feols(
  accident_count ~ treatment * is_urban | buffer_id + month,
  data = panel_data %>% filter(!is.na(is_urban))
)

# Display model summary
summary(did_urban_model)
```

The heterogeneity analysis reveals striking differences in how construction affects accidents across urban and rural environments. The base treatment effect coefficient (-0.005) is not statistically significant, suggesting minimal impact of construction on accidents in rural areas. However, the interaction term (treatment × is_urbanTRUE) shows a large and highly significant coefficient of 0.163 (p < 0.01), indicating that in urban areas, construction is associated with an additional 0.163 accidents per month beyond any rural effect. This substantial urban-rural disparity (with urban areas experiencing approximately 16.3% more accidents during construction) suggests that traffic management challenges differ fundamentally between these environments, with urban construction zones posing significantly greater accident risks that require targeted mitigation strategies.

#### Normalized Accident Rate Model

To account for traffic volume differences, we also estimated models using normalized accident rates:

$$accident\_rate_{it} = \alpha + \beta_1 treatment_{it} + \gamma_t + \delta_i + \varepsilon_{it}$$

```{r rate_model}
# DiD with normalized accident rate
did_rate_model <- feols(
  accident_rate ~ treatment | buffer_id + month,
  data = panel_data %>% filter(!is.na(accident_rate))
)

# Display model summary
summary(did_rate_model)

# DiD with urban/rural heterogeneity and normalized rate
did_rate_urban_model <- feols(
  accident_rate ~ treatment * is_urban | buffer_id + month,
  data = panel_data %>% filter(!is.na(accident_rate), !is.na(is_urban))
)

# Display model summary
summary(did_rate_urban_model)
```

When examining normalized accident rates per 10,000 vehicles, we observe different patterns than in the absolute count models. In the base rate model, the treatment effect is positive but not statistically significant (0.013, p=0.41), suggesting that after controlling for traffic exposure, construction's impact on accident rates is more nuanced.

However, the urban heterogeneity model for normalized rates shows a similar pattern to our count model: the base treatment effect for rural areas is negative (-0.059, p=0.12) though not statistically significant, while the urban interaction term is positive and significant (0.110, p<0.01). This indicates that in urban areas, construction is associated with an increase of 0.110 accidents per 10,000 vehicles compared to rural areas. These normalized models provide important context by accounting for traffic volume differences, suggesting that the urban-rural disparity in construction impacts persists even after controlling for exposure levels.

#### Spatial Econometric Models

To account for spatial dependence, we implemented spatial lag models:

```{r spatial_models}
# Create a sample data for spatial analysis (one month snapshot)
test_month <- as.Date("2021-06-01")
spdata <- panel_data %>%
  filter(month == test_month)

# Add spatial coordinates to the panel data
spdata <- spdata %>%
  left_join(
    const_buffers %>%
      st_centroid() %>%
      mutate(
        X = st_coordinates(.)[,1],
        Y = st_coordinates(.)[,2]
      ) %>%
      st_drop_geometry() %>%
      select(buffer_id, X, Y),
    by = "buffer_id"
  )

# Create spatial weights
spw_coords <- spdata %>%
  select(X, Y) %>%
  as.matrix()

# Create spatial weights - might need to adjust distance for our specific data
sp_nb <- spdep::dnearneigh(spw_coords, d1 = 0, d2 = 5000)
spw <- spdep::nb2listw(sp_nb, style = "W", zero.policy = TRUE)

# Spatial lag model
spatial_model <- spatialreg::lagsarlm(
  accident_count ~ treatment + is_urban + log(traffic_volume + 1),
  data = spdata,
  listw = spw,
  method = "Matrix",
  zero.policy = TRUE
)

# Display model summary
summary(spatial_model)
```

The spatial lag model confirms the presence of significant spatial autocorrelation in accident patterns, with a spatial lag parameter (ρ) of 0.765 (p < 0.001). This high and statistically significant value indicates strong spatial clustering in accident occurrences, where accident rates in one location are substantially influenced by rates in neighboring areas. 

After accounting for this spatial dependence, the treatment effect of construction remains positive and significant (0.622, p < 0.001), providing additional evidence for our main finding. The model also identifies a negative effect of urban classification (-0.256, p < 0.01), likely reflecting the fixed characteristics of urban areas that are captured in this cross-sectional spatial model rather than the panel approach. The significant positive coefficient for traffic volume (0.438, p < 0.001) confirms the expected relationship between traffic exposure and accident frequency. This spatial analysis strengthens our causal claims by demonstrating that construction effects persist even after controlling for complex spatial dependencies.

#### Spatial Spillover Analysis

To examine how construction impacts extend beyond the immediate construction zone, we implemented distance band models:

```{r spillover_model}
# Create distance bands from construction sites
panel_data <- panel_data %>%
  mutate(
    distance_band = cut(
      distance_to_nearest,
      breaks = c(0, 500, 1000, 2000, 5000, Inf),
      labels = c("0-500m", "500-1000m", "1-2km", "2-5km", ">5km")
    )
  )

# Test for spillover effects across distance bands
spillover_model <- feols(
  accident_count ~ i(distance_band, treatment, ref = ">5km") | buffer_id + month,
  data = panel_data %>% filter(!is.na(distance_band))
)

# Display model summary
summary(spillover_model)
```

Our spatial spillover analysis reveals nuanced effects extending beyond the immediate construction zone. Using the ">5km" distance band as reference, we find that areas within 0-500m of construction sites show a negative but non-significant effect (-0.064, p=0.93), which may reflect successful traffic management or diversion within immediate construction boundaries. 

Notably, the strongest positive effects appear in the 500-1000m band (0.308, p<0.001) and 1-2km band (0.312, p<0.001), indicating significantly higher accident rates in these transition zones where traffic flow and driver behavior adjust to approaching or leaving construction. Even in the 2-5km band, we observe a smaller but still significant effect (0.139, p<0.001). These findings suggest that safety management strategies should extend well beyond immediate construction boundaries, with particular attention to transition zones where accident risk may actually be higher than at the construction site itself due to changing traffic patterns and driver adaptation.

#### Event Study Analysis

To test for parallel trends and examine dynamic effects, we implemented an event study approach:

```{r event_study}
# Create relative time variable
panel_data <- panel_data %>%
  mutate(
    rel_time = as.numeric(difftime(month, start_date, units = "days")) / 30,
    rel_time_cat = cut(rel_time, 
                       breaks = c(-Inf, -12, -6, -3, 0, 3, 6, 12, Inf),
                       labels = c("<-12m", "-12to-6m", "-6to-3m", "-3to0m", 
                                  "0to3m", "3to6m", "6to12m", ">12m"))
  )

# Event study model
event_study_model <- feols(
  accident_count ~ i(rel_time_cat, ref = "-3to0m") | buffer_id + month,
  data = panel_data %>% filter(!is.na(rel_time_cat))
)

# Display model summary
summary(event_study_model)
```

The event study results provide temporal context for our difference-in-differences estimates. Using the period 3 months before construction ("-3to0m") as the reference, we observe that locations destined for construction show significantly lower accident rates far before construction begins ("<-12m" coefficient = -0.690, p<0.001), with this difference gradually diminishing as construction approaches. 

During and after construction (0to3m, 3to6m, 6to12m, >12m), coefficients are close to zero and not statistically significant, suggesting accident rates similar to the pre-construction reference period. This pattern supports the parallel trends assumption required for causal interpretation of our DiD results, as we don't see diverging pre-trends immediately before treatment. The significant difference in very early periods may reflect long-term planning effects, where areas selected for eventual construction have different characteristics. Overall, these results strengthen our causal claims by demonstrating appropriate temporal patterns in the data.

# Results

## Descriptive Statistics

Our analysis covered a large number of accidents and construction projects across California in 2021. The spatial distribution analysis included the urban-rural breakdown, which is critical for understanding the heterogeneous effects of construction on accident rates.

```{r summary_stats_table}
# Calculate actual summary statistics
summary_stats_df <- panel_data %>%
  filter(!is.na(is_urban)) %>%
  group_by(treatment, is_urban) %>%
  summarize(
    num_observations = n(),
    mean_accidents = mean(accident_count, na.rm = TRUE),
    median_accidents = median(accident_count, na.rm = TRUE),
    max_accidents = max(accident_count, na.rm = TRUE),
    mean_accident_rate = mean(accident_rate, na.rm = TRUE)
  ) %>%
  ungroup()

kableExtra::kable(summary_stats_df, 
                 col.names = c("Construction", "Urban", "Observations", "Mean Accidents", 
                               "Median Accidents", "Max Accidents", "Mean Accident Rate"),
                 caption = "Summary Statistics by Treatment Status and Urban/Rural Classification",
                 booktabs = TRUE,
                 digits = 3) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                           full_width = TRUE) %>%
  kableExtra::row_spec(0, bold = TRUE)
```

The summary statistics reveal stark differences in accident patterns across urban-rural divides and construction status. In rural areas without construction (FALSE, FALSE), the mean accident count is 0.647 with a median of 0, while in urban areas without construction (FALSE, TRUE), the mean jumps to 4.383 with a median of 1 – nearly seven times higher. Similarly, during active construction, urban areas (TRUE, TRUE) show mean accident counts of 4.672 compared to 0.783 in rural areas (TRUE, FALSE).

Notably, when examining normalized accident rates per 10,000 vehicles, the urban-rural gap narrows substantially: rural areas show rates of 0.986 (without construction) and 0.827 (with construction), while urban areas show rates of 0.395 (without construction) and 0.448 (with construction). This suggests that higher urban accident counts are partly explained by higher traffic volumes. The data also reveals that construction appears to reduce normalized accident rates in rural areas (-16%) while increasing them in urban areas (+13%), providing preliminary evidence for heterogeneous effects that will be further examined in our regression models.

## Difference-in-Differences Results

Table 3 presents the results from our main difference-in-differences models.

```{r did_models_table}
# Compare DiD models
did_models_table <- etable(
  did_model, 
  did_urban_model, 
  did_rate_model, 
  did_rate_urban_model,
  headers = c("Base", "Urban Het.", "Rate", "Rate Urban"),
  digits = 3
)

# Print the comparison table
print(did_models_table)
```

The difference-in-differences models provide robust evidence for the causal impact of construction on accident rates, with important heterogeneity across urban and rural environments. The base model shows a significant positive effect of construction (treatment = 0.101, p < 0.001), indicating that construction activities increase accident counts by approximately 10.1% on average.

When examining urban-rural heterogeneity, we find that the effect is concentrated in urban areas: while the base treatment effect (representing rural areas) is actually negative but insignificant (-0.005), the urban interaction term is strongly positive (0.163, p < 0.01), indicating substantially higher accident rates during construction in urban environments.

The normalized rate models (controlling for traffic volume) show complementary results, with the urban interaction term remaining significant (0.110, p < 0.01) even after traffic exposure normalization. This strengthens our conclusion that urban and rural areas experience fundamentally different safety impacts from construction activities, with urban construction zones posing greater accident risks that cannot be explained solely by traffic volume differences.

## Spatial Lag Model Results

The spatial lag model confirms the presence of significant spatial autocorrelation, indicating that accident patterns exhibit strong spatial clustering. After accounting for this spatial dependence, we can examine construction effects:

```{r spatial_model_table}
# Extract actual spatial model results
spatial_sum <- summary(spatial_model)

# Create data frame with model results
coef_table <- as.data.frame(spatial_sum$Coef)
rho_row <- data.frame(
  Estimate = spatial_sum$rho,
  Std_Error = sqrt(spatial_sum$rho.se),
  z_value = spatial_sum$rho / sqrt(spatial_sum$rho.se),
  p_value = 2 * pnorm(abs(spatial_sum$rho / sqrt(spatial_sum$rho.se)), lower.tail = FALSE)
)

names(rho_row) <- names(coef_table)

# Combine into one table
spatial_model_df <- rbind(
  coef_table,
  rho_row
)

# Add variable names
spatial_model_df$Variable <- c(
  "Intercept", 
  "Treatment", 
  "Urban", 
  "log(Traffic Volume)",
  "Spatial Lag (ρ)"
)

# Format p-values
spatial_model_df$p_value_fmt <- ifelse(
  spatial_model_df$`Pr(>|z|)` < 0.001, 
  "<0.001", 
  sprintf("%.3f", spatial_model_df$`Pr(>|z|)`)
)

# Select and reorder columns
spatial_model_df <- spatial_model_df %>%
  select(Variable, Estimate, `Std. Error` = `Std. Error`, `z value`, `Pr(>|z|)` = p_value_fmt)

kableExtra::kable(spatial_model_df, 
                 col.names = c("Variable", "Estimate", "Std. Error", "z-value", "p-value"),
                 caption = "Spatial Lag Model Results",
                 booktabs = TRUE,
                 digits = 3) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"),
                           full_width = FALSE) %>%
  kableExtra::row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(sprintf("Model statistics: Log likelihood: %.1f, AIC: %.1f", 
                                  spatial_sum$LL, spatial_sum$AIC), 
                          notation = "none")
```

The spatial lag model provides strong evidence for both spatial dependencies in accident patterns and the impact of construction activities. The spatial lag parameter (ρ = 0.765, p < 0.001) confirms significant spatial autocorrelation, indicating that accident rates in one location are strongly influenced by neighboring areas. Even after accounting for this spatial clustering, the treatment effect of construction remains positive and highly significant (0.622, p < 0.001), providing additional support for our main finding.

Interestingly, in this cross-sectional spatial model, the Urban coefficient is negative (-0.256, p = 0.001), likely capturing fixed characteristics of urban areas rather than the treatment interaction effects seen in our panel models. The significant positive coefficient for traffic volume (0.438, p < 0.001) confirms the expected relationship between traffic exposure and accident frequency. With a log-likelihood of -101588.9 and AIC of 203190.0, the model demonstrates good fit, strengthening our confidence in the identified spatial relationships and treatment effects.

## Spatial Spillover Effects

Our spillover analysis examined how construction impacts extend to different distance bands from the construction site. Figure 1 presents these results.

```{r spillover_figure, fig.cap="Treatment Effects by Distance from Construction", fig.width=8, fig.height=5}
# Extract actual spillover model results
plot_spillover <- coefplot(spillover_model, 
          drop = "Intercept", 
          xlab = "Effect on Accident Count", 
          main = "Treatment Effect by Distance from Construction")

print(plot_spillover)
```

The spillover analysis reveals a non-intuitive spatial pattern of construction effects on accident rates. Using areas beyond 5km as the reference category, we observe that the immediate construction zone (0-500m) shows a slight negative but non-significant effect (-0.064, p=0.93), possibly reflecting successful traffic management or driver avoidance of these areas.

However, the strongest positive effects appear in transition zones: the 500-1000m band (0.308, p<0.001) and 1-2km band (0.312, p<0.001) show statistically significant increases in accident counts, with magnitudes over three times larger than our base model estimate. Even in the 2-5km band, we observe a smaller but still significant effect (0.139, p<0.001).

This spatial pattern suggests that accident risk may actually peak in areas approaching or leaving construction zones rather than within them, where speed changes, lane merges, and driver adjustment to changing conditions create hazardous transition environments. These findings have important implications for traffic management, indicating that safety measures should extend well beyond construction boundaries with particular attention to these high-risk transition zones.

## Event Study Results

The event study approach allows us to examine the dynamic effects of construction and test the parallel trends assumption.

```{r event_study_figure, fig.cap="Event Study: Effects Relative to Construction Start", fig.width=8, fig.height=5}
# Plot event study
plot_event_study <- coefplot(event_study_model,
                           xlab = "Time Relative to Construction Start",
                           ylab = "Effect on Accident Count",
                           main = "Event Study: Effect of Construction on Accidents")

print(plot_event_study)
```

The event study results reveal important temporal dynamics in accident patterns around construction periods. Using the 3 months before construction start as the reference period, we observe that areas selected for construction have significantly lower accident rates long before construction begins (coefficient for "<-12m" = -0.690, p<0.001), with this difference gradually diminishing as construction approaches.

During and after construction (periods "0to3m" through ">12m"), coefficients remain close to zero and statistically insignificant, indicating accident rates similar to the immediate pre-construction period. This pattern supports two important conclusions: (1) the parallel trends assumption necessary for causal interpretation of our DiD estimates is reasonably satisfied in the periods immediately before treatment, and (2) the long-term pre-construction difference suggests selection effects in areas chosen for construction projects.

These temporal dynamics provide context for interpreting our main results, suggesting that while construction causes a relative increase in accidents compared to the immediate pre-construction period, accident rates might still be lower than in typical non-construction areas due to selection effects. This nuanced interpretation strengthens our analysis by accounting for temporal heterogeneity in treatment effects.

## Accident Severity Analysis

We also examined how construction affects accident severity, classified by severity levels.

```{r severity_analysis}
# Analyze actual accident severity by construction period
severity_analysis <- accidents_in_buffers %>%
  st_drop_geometry() %>%
  filter(!is.na(time_period)) %>%
  count(time_period, Severity) %>%
  group_by(time_period) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()

# Format severity for better display
severity_analysis <- severity_analysis %>%
  mutate(
    Severity_factor = factor(
      Severity, 
      levels = sort(unique(Severity)),
      labels = c("Slight", "Moderate", "Serious", "Fatal")[1:length(unique(Severity))]
    )
  )

# Display severity distribution
kable(
  severity_analysis %>%
    select(time_period, Severity, n, proportion) %>%
    mutate(proportion = proportion * 100) %>%
    arrange(time_period, Severity),
  col.names = c("Construction Period", "Severity Level", "Count", "Percentage (%)"),
  caption = "Distribution of Accident Severity by Construction Period",
  digits = 1
)
```

```{r severity_figure, fig.cap="Accident Severity by Construction Period", fig.width=8, fig.height=5}
# Visualize accident severity distribution
ggplot(severity_analysis, aes(x = time_period, y = proportion, fill = Severity_factor)) +
  geom_col() +
  scale_fill_brewer(palette = "Blues") +
  labs(
    title = "Accident Severity Distribution by Construction Period",
    x = "Relation to Construction",
    y = "Proportion of Accidents",
    fill = "Severity"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    axis.title = element_text(size = 12),
    panel.grid.minor = element_blank()
  )
```

The severity analysis reveals a remarkably consistent distribution of accident severity levels across different construction periods. Approximately 87% of accidents are classified as moderate severity (level 2) across all periods, with around 12% categorized as serious (level 3) and less than 1% as either slight (level 1) or fatal (level 4).

This stability suggests that while construction impacts accident frequency, as demonstrated in our main models, it does not substantially alter the proportional severity distribution. This finding has important implications for safety planning, indicating that construction zones don't necessarily produce more severe accidents but rather increase the overall number of accidents while maintaining similar severity patterns. Traffic management strategies should therefore focus primarily on reducing accident occurrence rather than specifically targeting severity reduction, as the underlying severity distribution appears to be a stable characteristic of the road network and driver behavior.

# Discussion

## Interpretation of Main Findings

Our analysis provides robust evidence that road construction causally impacts traffic accident rates, with important heterogeneity across urban and rural environments. The main findings can be summarized as follows:

1. **Overall Construction Effect**: Our base difference-in-differences model reveals a statistically significant increase in accident counts during construction periods (coefficient = 0.101, p < 0.001), indicating that road construction activities are associated with approximately 10.1% more accidents compared to non-construction periods.

2. **Urban-Rural Heterogeneity**: The impact of construction on accidents differs substantially between urban and rural environments. In urban areas, construction is associated with a significant increase in accident counts (interaction coefficient = 0.163, p < 0.01), while in rural areas, there is evidence of potentially reduced accidents during construction (base coefficient = -0.005, though not statistically significant). This heterogeneity may be explained by several factors:
   - Higher traffic density in urban areas creates more complex interactions around construction zones
   - Rural construction may induce more cautious driving or effective traffic diversion
   - Urban construction often involves more complex traffic management challenges

3. **Spatial Spillover Effects**: The spatial spillover analysis shows that construction impacts extend beyond the immediate construction zone, with effects varying by distance. Areas 500m-2km from construction sites show the largest increases in accident rates (coefficients 0.308-0.312, p < 0.001), while immediate construction zones (0-500m) show minimal effects. This suggests that transition zones where traffic adjusts to approaching or leaving construction are particularly high-risk areas that warrant targeted safety measures.

4. **Temporal Dynamics**: The event study results show that locations selected for construction have different accident patterns long before construction begins, with accident rates gradually approaching the reference period as construction nears. This suggests potential selection effects in areas chosen for construction projects and provides context for interpreting our main treatment effects.

5. **Severity Patterns**: Our severity analysis shows a consistent distribution of accident severity levels across different construction periods (approximately 87% moderate, 12% serious), indicating that construction affects accident frequency but not the underlying severity distribution.

## Policy Implications

These findings have several important policy implications for transportation safety planning:

1. **Targeted Resource Allocation**: Traffic management resources should be allocated differentially between urban and rural construction zones, with greater emphasis on urban areas where construction effects on accidents are typically larger (coefficient = 0.163, p < 0.01 for urban interaction). Rural construction zones may require less intensive intervention given their potentially neutral or even positive safety effects.

2. **Extended Safety Zones**: Traffic safety measures should not be limited to the immediate construction zone but should extend to areas surrounding construction sites, particularly the 500m-2km transition zones where our spillover analysis indicates significant effects (coefficients 0.308-0.312, p < 0.001). This could include enhanced signage, speed management, and temporary traffic calming measures in these approach and departure areas.

3. **Temporal Planning**: The temporal patterns revealed in our event study suggest that enhanced safety measures may be particularly important during specific phases of construction projects. The relatively stable accident rates during and after construction compared to the immediate pre-construction period suggest that current construction management practices may be partially effective but could be further improved.

4. **Severity-Focused Strategies**: Our severity analysis provides insights for emergency response planning and the design of safety measures. Since the severity distribution remains consistent across construction periods, general accident prevention measures rather than severity-specific interventions may be most effective.

## Limitations and Future Research

While our study provides evidence on the causal impact of construction on accidents, several limitations should be noted:

1. **Time Period**: Our analysis is limited to data from 2021, which may have been affected by pandemic-related traffic patterns. Future research should examine longer time periods and potential yearly variations.

2. **Granularity**: While we distinguish between urban and rural areas, more detailed classifications (e.g., suburban, exurban) could provide additional insights for targeted interventions.

3. **Construction Types**: Our data does not allow us to consistently differentiate between different types of construction activities (e.g., resurfacing, bridge repair, lane expansion), which may have different safety implications.

4. **Weather and Seasonal Effects**: While our models include time fixed effects that partly control for seasonal patterns, more explicit modeling of weather interactions with construction effects could yield valuable insights.

5. **Endogeneity**: Despite our use of a DiD framework, unobserved confounders may still bias our estimates. Future research could explore instrumental variable approaches or quasi-experimental designs to address endogeneity concerns.

6. **AADT data**: The AADT data used for traffic volume normalization may include estimates or projections that do not precisely match the 2021 study period, potentially introducing minor measurement uncertainties.

Future research should address these limitations and further explore the mechanisms underlying the observed heterogeneity in construction effects.

# Conclusion

This study provides evidence on the relationship between road construction and traffic accidents in California. Using high-resolution spatial data and advanced econometric methods, we demonstrate that construction activities significantly impact accident rates, with effects that vary substantially between urban and rural environments and extend beyond the immediate construction zone.

The findings have important implications for transportation safety planning, suggesting the need for targeted resource allocation, extended safety zones, and temporally-focused safety measures. By implementing these recommendations, transportation authorities can better mitigate the safety risks associated with necessary infrastructure maintenance and development.

Our methodological approach combines spatial analysis with causal inference techniques, providing a framework that can be extended to other regions and contexts. By continuing to refine these methods and addressing the limitations noted, future research can further enhance our understanding of the complex relationship between construction activities and traffic safety.

# References

Ahmed, M. M., Franke, R., Ksaibati, K., & Shinstine, D. S. (2018). Effects of truck traffic on crash injury severity on rural highways in Wyoming using Bayesian binary logit models. *Accident Analysis & Prevention*, 117, 106-113.

Li, Y., & Bai, Y. (2008). Comparison of characteristics between fatal and injury accidents in the highway construction zones. *Safety Science*, 46(4), 646-660.